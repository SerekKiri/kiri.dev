---
import { Image } from "astro:assets"
import profileImage from "/public/profile.jpeg"
---

<Image
  src={profileImage}
  alt="Profile photo"
  class="profile-image"
  width={240}
  height={240}
  quality={100}
  format="webp"
  loading="eager"
/>

<style>
  .profile-image {
    border-radius: 50%;
    object-fit: cover;
    object-position: center;
    transform: scale(1);
    image-rendering: -webkit-optimize-contrast;
    -webkit-backface-visibility: hidden;
    -webkit-transform: translateZ(0);
    backface-visibility: hidden;
    transform: translateZ(0);
    border: 3px solid #e5e7eb;
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: transform 0.2s ease-in-out;
    position: relative;
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s infinite;
  }

  .profile-image.loaded {
    background: none;
    animation: none;
  }

  @keyframes skeleton-loading {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  .profile-image:hover {
    transform: scale(1.25);
  }

  /* Safari-specific optimizations */
  @media screen and (-webkit-min-device-pixel-ratio: 2) {
    .profile-image {
      image-rendering: -webkit-optimize-contrast;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  }

  /* Responsive design */
  @media (max-width: 768px) {
    .profile-image {
      width: 150px;
      height: 150px;
      image-rendering: -webkit-optimize-contrast;
      -webkit-backface-visibility: hidden;
      -webkit-transform: translateZ(0);
    }

    .profile-image:hover {
      transform: none;
    }
  }

  @media (max-width: 480px) {
    .profile-image {
      width: 180px;
      height: 180px;
      image-rendering: -webkit-optimize-contrast;
      -webkit-backface-visibility: hidden;
      -webkit-transform: translateZ(0);
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const profileImage = document.querySelector(".profile-image")
    if (profileImage) {
      profileImage.addEventListener("load", function (this: HTMLImageElement) {
        this.classList.add("loaded")
      })
    }
  })
</script>
